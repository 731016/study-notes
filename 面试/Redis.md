[TOC]



## redis主从复制的实现原理

[Redis 主从复制的实现原理是什么？ - Redis 面试题 - 面试鸭 - 程序员求职面试刷题神器](https://www.mianshiya.com/bank/1791375592078610434/question/1780933295647780865#heading-0)

全量同步

![image-20250110212823261](https://note-1259190304.cos.ap-chengdu.myqcloud.com/noteimage-20250110212823261.png)

增量同步

![image-20250110213006553](https://note-1259190304.cos.ap-chengdu.myqcloud.com/noteimage-20250110213006553.png)

## redis集群的实现原理

[Redis 集群的实现原理是什么？ - Redis 面试题 - 面试鸭 - 程序员求职面试刷题神器](https://www.mianshiya.com/bank/1791375592078610434/question/1780933295651975169#heading-0)

通过多个redis实例组成，每个实例存储部分数据。使用哈希槽机制来分配数据，将整个键空间划分为16384（2^14）个槽。每个redis实例负责一定范围的哈希槽，数据的key经过哈希函数计算后对16384取余可定位到对应节点。

各个节点使用gossip协议通信，每个节点都会保存集群的完整拓扑信息，包括节点id、ip地址、端口、负责的哈希槽范围

> 16384？
>
> 发生节点负责的槽信息
>
> unsigned char myslots[CLUSTER_SLOTS/8]
>
> 当槽位为65536时，65536/8/1024=8 kb
>
> 当槽位为16384时，16384/8/1024=2 kb
>
> 考虑消息大小和集群规模
>
> 65536这个ping消息的消息头就会过大浪费带宽
>
> 集群不太可能会扩展超过1000个节点，16384够用

## redis通常应用于哪些场景？

[Redis 通常应用于哪些场景？ - Redis 面试题 - 面试鸭 - 程序员求职面试刷题神器](https://www.mianshiya.com/bank/1791375592078610434/question/1780933295584866306#heading-0)

1. 缓存：热点数据缓存，减少数据库的负载，先查缓存，再查数据库（加锁），如果数据库无数据可在缓存写入null，应对缓存穿透
2. 分布式锁：分布式系统资源的安全访问
3. 实时系统：适合实时分析，如网站点击统计、实时排行榜（zset数据结构）
4. 计数器：原子性适合，如点赞
5. 消息队列：list的Pub/Sub功能，实现轻量级的消息队列



